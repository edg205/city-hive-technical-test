<div class="page">
  <div class="header">
    <h2>Messages</h2>
    <div class="actions">
      <button (click)="refresh()">Refresh</button>
      <button (click)="logout()">Logout</button>
    </div>
  </div>

  @if (error) {
    <p class="error">{{ error }}</p>
  }

  <div class="composer">
    <label>
      To number
      <input [(ngModel)]="to_number" placeholder="+1..." />
    </label>

    <label>
      Message
      <textarea [(ngModel)]="body" rows="3"></textarea>
    </label>

    <button (click)="send()" [disabled]="loading || !body || !to_number">
      {{ loading ? 'Sending...' : 'Send SMS' }}
    </button>
  </div>

  <div class="list">
    @for (m of messages; track m.id) {
      <div class="card">
        <div class="meta">
          <div><strong>To:</strong> {{ m.to_number }}</div>

          <div class="status">
            <strong>Status:</strong> {{ m.status }}
            @if (m.error_code) {
              <span> ({{ m.error_code }})</span>
            }
          </div>
        </div>

        <div class="body">{{ m.body }}</div>
        <div class="time">{{ m.created_at | date:'medium' }}</div>
      </div>
    }
  </div>
</div>
